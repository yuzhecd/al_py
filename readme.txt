this is the algorithm that I use python.
